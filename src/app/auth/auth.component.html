<div class="container d-flex justify-content-center align-items-center vh-100">
  <div class="card shadow-lg border-0 w-100" style="max-width: 900px;">
    <div class="row g-0">
      <!-- Login Form -->
      <div class="col-md-6 p-4 border-end">
        <h4 class="mb-4 text-center">Login</h4>
        @if (!isLoggedIn) {
        <form name="loginForm" (ngSubmit)="loginForm.valid && onLogin()" #loginForm="ngForm" novalidate>
          <div class="mb-3">
            <label class="form-label">Username</label>
            <input
              type="text"
              class="form-control"
              name="username"
              [(ngModel)]="login.username"
              required
              #loginUsername="ngModel"
              [ngClass]="{ 'is-invalid': loginForm.submitted && loginUsername.invalid }"
            />
            <div class="invalid-feedback">Username is required</div>
          </div>

          <div class="mb-3">
            <label class="form-label">Password</label>
            <input
              type="password"
              class="form-control"
              name="password"
              [(ngModel)]="login.password"
              required
              minlength="4"
              #loginPassword="ngModel"
              [ngClass]="{ 'is-invalid': loginForm.submitted && loginPassword.invalid }"
            />
            <div class="invalid-feedback">Password is required (min 4 characters)</div>
          </div>

          <div class="d-grid">
            <button class="btn btn-primary">Login</button>
          </div>

          <div class="mt-3">
            @if (loginForm.submitted && isLoginFailed) {
              <div class="alert alert-danger" role="alert">
                Login failed: {{ loginErrorMessage }}
              </div>
            }
          </div>
        </form>
        } @else {
          <div class="alert alert-success">Login successful</div>
        }
      </div>

      <!-- Register Form -->
      <div class="col-md-6 p-4">
        <h4 class="mb-4 text-center">Register</h4>
        @if (!isSuccessful) {
        <form name="registerForm" (ngSubmit)="registerForm.valid && onRegister()" #registerForm="ngForm" novalidate>
          <div class="mb-3">
            <label class="form-label">Username</label>
            <input
              type="text"
              class="form-control"
              name="username"
              [(ngModel)]="register.username"
              required
              minlength="3"
              maxlength="20"
              #regUsername="ngModel"
              [ngClass]="{ 'is-invalid': registerForm.submitted && regUsername.invalid }"
            />
            <div class="invalid-feedback">Username must be 3–20 characters</div>
          </div>

          <div class="mb-3">
            <label class="form-label">Full Name</label>
            <input
              type="text"
              class="form-control"
              name="fullname"
              [(ngModel)]="register.fullname"
              required
              minlength="3"
              maxlength="80"
              #regFullname="ngModel"
              [ngClass]="{ 'is-invalid': registerForm.submitted && regFullname.invalid }"
            />
            <div class="invalid-feedback">Full name must be 3–80 characters</div>
          </div>

          <div class="mb-3">
            <label class="form-label">Email</label>
            <input
              type="email"
              class="form-control"
              name="email"
              [(ngModel)]="register.email"
              required
              #regEmail="ngModel"
              [ngClass]="{ 'is-invalid': registerForm.submitted && regEmail.invalid }"
            />
            <div class="invalid-feedback">Enter a valid email</div>
          </div>

          <div class="mb-3">
            <label class="form-label">Password</label>
            <input
              type="password"
              class="form-control"
              name="password"
              [(ngModel)]="register.password"
              required
              minlength="6"
              #regPassword="ngModel"
              [ngClass]="{ 'is-invalid': registerForm.submitted && regPassword.invalid }"
            />
            <div class="invalid-feedback">Password must be at least 6 characters</div>
          </div>

          <div class="d-grid">
            <button class="btn btn-success">Sign Up</button>
          </div>

          <div class="mt-3">
            @if (registerForm.submitted && isSignUpFailed) {
              <div class="alert alert-warning">Signup failed! {{ registerErrorMessage }}</div>
            }
          </div>
        </form>
        } @else {
          <div class="alert alert-success">Your registration was successful!<br>Please login to proceed</div>
        }
      </div>
    </div>
  </div>
</div>
